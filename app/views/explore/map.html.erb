<div id="exploreMap" class="exploreMap"></div>
<script>

    function initMap() {
        var invaderList = [];
        // Create a map object and specify the DOM element for display.
        var map = new google.maps.Map(document.getElementById('exploreMap'), {
            center: {
                lat: 46.9425775,
                lng: 7.4524558
            },
            disableDefaultUI: true,
            scrollwheel: true,
            zoom: 12,
            zoomControl: true
        });

        var styles = [
  {
    stylers: [
      { hue: "#000000" },
      { saturation: -20 }
    ]
  },{
    featureType: "road",
    elementType: "geometry",
    stylers: [
      { lightness: 100 },
      { visibility: "simplified" }
    ]
  },{
    featureType: "poi",
    stylers: [
      { visibility: "off" }
    ]
  }
];

map.setOptions({styles: styles});

        $.getJSON('/invaders.json', function (data) {
            console.log(data);
            $.each(data, function (i, invader) {
                invaderList[i] = [];
                var LatLngSplit = invader['location'].split(','),
                    lat = LatLngSplit[0],
                    lng = LatLngSplit[1];

                myLatLng = new google.maps.LatLng(parseFloat(lat), parseFloat(lng));
                console.log(invader['name']);
                var marker = new google.maps.Marker({position: myLatLng, map: map,
                  icon: {
  		              url: "/images/invader.png",
  		              scaledSize: new google.maps.Size(25, 25)
  	              },

                });

                marker.addListener('click', function () {
                    window.location.href = "/invaders/" + invader['id'];
                });

                var cityCircle = new google.maps.Circle({
                    strokeColor: '#FF0000',
                    strokeOpacity: 0,
                    strokeWeight: 2,
                    fillColor: '#FF0000',
                    fillOpacity: 0.35,
                    map: map,
                    center: myLatLng,
                    radius: parseInt(invader['accuracy'])
                });

            });

        });

        var myloc = new google.maps.Marker({
            clickable: false,
            icon: new google.maps.MarkerImage('//maps.gstatic.com/mapfiles/mobile/mobileimgs2.png',
                                                            new google.maps.Size(22,22),
                                                            new google.maps.Point(0,18),
                                                            new google.maps.Point(11,11)),
            shadow: null,
            zIndex: 999,
            map: map
        });

        if (navigator.geolocation) navigator.geolocation.getCurrentPosition(function(pos) {
            var me = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
            myloc.setPosition(me);
        }, function(error) {
            // ...
        });

    }
</script>


<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyApOWJ0BYbS9dOM2PK0vTJgxA4xVDRlnmk&callback=initMap" async defer></script>
